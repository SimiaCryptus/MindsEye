# ConvolutionLayer
## ConvolutionLayerTest
### Json Serialization
Code from [LayerTestBase.java:84](../../../../../../../../MindsEye/src/test/java/com/simiacryptus/mindseye/layers/LayerTestBase.java#L84) executed in 0.04 seconds: 
```java
    JsonObject json = layer.getJson();
    NNLayer echo = NNLayer.fromJson(json);
    assert (echo != null) : "Failed to deserialize";
    assert (layer != echo) : "Serialization did not copy";
    Assert.assertEquals("Serialization not equal", layer, echo);
    return new GsonBuilder().setPrettyPrinting().create().toJson(json);
```

Returns: 

```
    {
      "class": "com.simiacryptus.mindseye.layers.aparapi.ConvolutionLayer",
      "id": "c88cbdf1-1c2a-4a5e-b964-890900000001",
      "isFrozen": false,
      "name": "ConvolutionLayer/c88cbdf1-1c2a-4a5e-b964-890900000001",
      "filter": {
        "dimensions": [
          3,
          3,
          4
        ],
        "data": [
          1.02,
          -0.54,
          -1.38,
          -1.796,
          -0.7,
          0.572,
          0.576,
          -1.128,
          0.456,
          -1.276,
          -0.74,
          0.208,
          0.752,
          -0.572,
          1.596,
          -1.228,
          1.824,
          0.952,
          -1.048,
          -0.476,
          -0.828,
          -0.888,
          -0.512,
          1.144,
          1.24,
          -0.06,
          -1.528,
          -0.784,
          -1.568,
          -1.896,
          -0.976,
          -1.3,
          1.692,
          -0.12,
          1.356,
          0.204
        ]
      },
      "skip": {
        "dimensions": [
          1,
          1
        ]
      },
      "simple": true
    }
```



### Example Input/Output Pair
Code from [LayerTestBase.java:121](../../../../../../../../MindsEye/src/test/java/com/simiacryptus/mindseye/layers/LayerTestBase.java#L121) executed in 0.29 seconds: 
```java
    SimpleEval eval = SimpleEval.run(layer, inputPrototype);
    return String.format("--------------------\nInput: \n[%s]\n--------------------\nOutput: \n%s",
      Arrays.stream(inputPrototype).map(t->t.prettyPrint()).reduce((a,b)->a+",\n"+b).get(),
      eval.getOutput().prettyPrint());
```

Returns: 

```
    --------------------
    Input: 
    [[
    	[ [ -0.62, -0.468 ], [ -0.664, -1.58 ], [ 0.552, 1.132 ] ],
    	[ [ -1.008, 0.184 ], [ -1.316, -1.588 ], [ -1.5, -1.928 ] ],
    	[ [ 1.592, -1.812 ], [ -0.972, 0.176 ], [ 0.308, 0.012 ] ]
    ]]
    --------------------
    Output: 
    [
    	[ [ 3.753136, 5.918448000000001 ], [ 5.076064000000001, 3.6864160000000004 ], [ 1.5567359999999995, -2.5806240000000007 ] ],
    	[ [ 0.986384, 8.945376 ], [ 1.6950880000000006, -4.131776 ], [ 6.433616, 2.0449759999999997 ] ],
    	[ [ 3.0193119999999998, 3.327968 ], [ -0.91264, -1.8386400000000007 ], [ -0.3731519999999997, -8.959007999999999 ] ]
    ]
```



### Differential Validation
Code from [LayerTestBase.java:139](../../../../../../../../MindsEye/src/test/java/com/simiacryptus/mindseye/layers/LayerTestBase.java#L139) executed in 0.55 seconds: 
```java
    getDerivativeTester().test(layer, inputPrototype);
```
Logging: 
```
    Component: ConvolutionLayer/c88cbdf1-1c2a-4a5e-b964-890900000001
    Inputs: [
    	[ [ -0.62, -0.468 ], [ -0.664, -1.58 ], [ 0.552, 1.132 ] ],
    	[ [ -1.008, 0.184 ], [ -1.316, -1.588 ], [ -1.5, -1.928 ] ],
    	[ [ 1.592, -1.812 ], [ -0.972, 0.176 ], [ 0.308, 0.012 ] ]
    ]
    output=[
    	[ [ 3.753136, 5.918448000000001 ], [ 5.076064000000001, 3.6864160000000004 ], [ 1.5567359999999995, -2.5806240000000007 ] ],
    	[ [ 0.986384, 8.945376 ], [ 1.6950880000000006, -4.131776 ], [ 6.433616, 2.0449759999999997 ] ],
    	[ [ 3.0193119999999998, 3.327968 ], [ -0.91264, -1.8386400000000007 ], [ -0.3731519999999997, -8.959007999999999 ] ]
    ]
    measured/actual: [ [ -0.700000000000145, 0.5720000000009051, 0.0, -1.1280000000013501, 0.4559999999997899, 0.0, 0.0, 0.0, 0.0, -0.5719999999964642 ], [ -1.796000000000575, -0.700000000000145, 0.5720000000009051, 0.5759999999987997, -1.1280000000013501, 0.4559999999997899, 0.0, 0.0, 0.0, 0.7520000000038607 ], [ 0.0, -1.796000000000575, -0.700000000000145, 0.0, 0.5759999999987997, -1.1280000000013501, 0.0, 0.0, 0.0, 0.0 ], [ -0.5399999999999849, -1.3800000000019352, 0.0, -0.700000000000145, 0.5719999999964642, 0.0, -1.1279999999924684, 0.4559999999997899, 0.0, -0.7399999999968543 ], [ 1.020000000000465, -0.5399999999999849, -1.3799999999974943, -1.796000000000575, -0.700000000000145, 0.5719999999986847, 0.5760000000076815, -1.1280000000013501, 0.4559999999997899, -1.2759999999989446 ], [ 0.0, 1.019999999996024, -0.5399999999999849, 0.0, -1.796000000000575, -0.700000000000145, 0.0, 0.5759999999987997, -1.1279999999969093, 0.0 ], [ 0.0, 0.0, 0.0, -0.5400000000044258, -1.3800000000063761, 0.0, -0.700000000000145, 0.5719999999964642, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 1.020000000000465, -0.5400000000044258, -1.3799999999974943, -1.796000000000575, -0.700000000000145, 0.5720000000009051, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 1.020000000000465, -0.5399999999999849, 0.0, -1.796000000000575, -0.700000000000145, 0.0 ], [ -0.5119999999969593, 1.1439999999995898, 0.0, -0.059999999999504894, -1.5279999999995297, 0.0, 0.0, 0.0, 0.0, -1.3000
```
...[skipping 4620 bytes](etc/1.txt)...
```
     1.592, -0.664, -1.316, -0.972, 0.552, -1.5, 0.308, 0.0 ], [ 0.0, -0.62, -1.008, 0.0, -0.664, -1.316, 0.0, 0.552, -1.5, 0.0 ], [ 0.0, 0.0, 0.0, -1.008, 1.592, 0.0, -1.316, -0.972, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, -0.62, -1.008, 1.592, -0.664, -1.316, -0.972, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, -0.62, -1.008, 0.0, -0.664, -1.316, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.316 ] ]
    Error: [ [ -9.481304630298837E-14, -3.525624236999647E-12, 0.0, -5.3859139370615594E-12, -6.6863736769562365E-12, 0.0, 0.0, 0.0, 0.0, 0.0 ], [ -1.3301582058034E-12, -9.481304630298837E-14, 9.15267861500979E-13, -6.331379864832343E-12, -5.3859139370615594E-12, 2.195410520045016E-12, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, -1.3301582058034E-12, -9.481304630298837E-14, 0.0, -6.331379864832343E-12, 3.495870259939693E-12, 0.0, 0.0, 0.0, 0.0 ], [ -2.34035013590983E-12, -3.070876886113183E-12, 0.0, -4.5357051448036145E-12, -7.966516335500273E-12, 0.0, 3.495870259939693E-12, 2.195410520045016E-12, 0.0, 0.0 ], [ -2.2853940961908847E-12, -2.34035013590983E-12, 1.3700152123874432E-12, -5.771050304304026E-12, -4.5357051448036145E-12, 9.15267861500979E-13, 2.5504043321689096E-12, 3.495870259939693E-12, 2.195410520045016E-12, 0.0 ], [ 0.0, 2.1554980023097414E-12, 2.100541962590796E-12, 0.0, 3.110733892697226E-12, -9.481304630298837E-14, 0.0, 2.5504043321689096E-12, -9.450218385609332E-13, 0.0 ], [ 0.0, 0.0, 0.0, -2.34035013590983E-12, -3.070876886113183E-12, 0.0, 4.346079052197638E-12, 9.15267861500979E-13, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, -6.726286194691511E-12, -2.34035013590983E-12, -8.504308368628699E-13, 3.110733892697226E-12, 4.346079052197638E-12, 9.15267861500979E-13, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 2.1554980023097414E-12, -1.199040866595169E-13, 0.0, 3.110733892697226E-12, -9.481304630298837E-14, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.346079052197638E-12 ] ]
    Finite-Difference Derivative Accuracy:
    absoluteTol: 1.0235e-12 +- 1.9423e-12 [0.0000e+00 - 1.5738e-11] (972#)
    relativeTol: 3.3417e-12 +- 1.0990e-11 [1.3981e-14 - 1.0690e-10] (392#)
    
```

### Performance
Code from [LayerTestBase.java:144](../../../../../../../../MindsEye/src/test/java/com/simiacryptus/mindseye/layers/LayerTestBase.java#L144) executed in 0.75 seconds: 
```java
    getPerformanceTester().test(layer, inputPrototype);
```
Logging: 
```
    Evaluation performance: 26.4462 +- 3.2257 [22.8867 - 39.6805]
    Learning performance: 20.4203 +- 1.4791 [18.1532 - 26.4090]
    
```

