# ConvolutionLayer
## IrregularTest
### Json Serialization
Code from [LayerTestBase.java:83](../../../../../../../../../../MindsEye/src/test/java/com/simiacryptus/mindseye/layers/LayerTestBase.java#L83) executed in 0.00 seconds: 
```java
    JsonObject json = layer.getJson();
    NNLayer echo = NNLayer.fromJson(json);
    assert (echo != null) : "Failed to deserialize";
    assert (layer != echo) : "Serialization did not copy";
    Assert.assertEquals("Serialization not equal", layer, echo);
    return new GsonBuilder().setPrettyPrinting().create().toJson(json);
```

Returns: 

```
    {
      "class": "com.simiacryptus.mindseye.layers.cudnn.f64.ConvolutionLayer",
      "id": "370a9587-74a1-4959-b406-fa45000014ca",
      "isFrozen": false,
      "name": "ConvolutionLayer/370a9587-74a1-4959-b406-fa45000014ca",
      "filter": {
        "dimensions": [
          3,
          3,
          18
        ],
        "data": [
          0.452,
          -0.328,
          -0.896,
          1.364,
          -1.216,
          -0.148,
          0.724,
          0.548,
          -0.42,
          1.188,
          1.724,
          1.932,
          0.924,
          -1.104,
          0.06,
          0.496,
          1.48,
          -0.612,
          -1.808,
          -0.372,
          1.528,
          -0.208,
          1.296,
          1.42,
          0.944,
          0.48,
          1.328,
          1.296,
          -0.4,
          1.288,
          -1.844,
          -0.344,
          -0.816,
          1.276,
          -0.12,
          0.932,
          -0.516,
          0.24,
          -0.16,
          -1.056,
          0.608,
          0.324,
          -1.712,
          -1.628,
          -1.4,
          1.628,
          0.772,
          -0.584,
          1.828,
          1.552,
          -1.332,
          -1.116,
          -1.208,
          -0.164,
          -0.204,
          -0.136,
          0.188,
          0.392,
          0.94,
          -0.288,
          0.248,
          1.024,
          1.704,
          0.516,
          0.956,
          -1.612,
          -1.896,
          -0.856,
          1.132,
          0.788,
          -1.692,
          0.136,
          1.18,
          -1.692,
          -1.02,
          0.128,
          0.632,
          -1.904,
          0.536,
          -0.464,
          0.832,
          1.504,
          -1.004,
          1.688,
          0.176,
          0.808,
          1.572,
          1.992,
          0.028,
          -1.676,
          0.972,
          -0.716,
          -0.988,
          -1.7,
          -0.488,
          1.616,
          1.616,
          -0.5,
          1.724,
          1.504,
          0.576,
          1.66,
          0.524,
          1.036,
          -1.34,
          -1.632,
          -0.88,
          1.932,
          0.74,
          0.34,
          -1.852,
          1.908,
          1.756,
          0.548,
          -1.0,
          -0.784,
          -0.188,
          0.62,
          -0.488,
          -1.688,
          -1.508,
          0.676,
          -1.556,
          1.808,
          1.372,
          -0.304,
          -1.088,
          -0.292,
          0.992,
          0.452,
          0.2,
          -1.516,
          0.344,
          1.988,
          -0.92,
          -0.668,
          -0.352,
          -0.024,
          -1.68,
          -0.696,
          0.772,
          -0.348,
          -1.632,
          -0.328,
          -0.544,
          0.192,
          0.984,
          -0.092,
          -1.18,
          0.884,
          0.228,
          0.728,
          -1.268,
          0.212,
          -0.548,
          -1.404,
          1.316,
          0.48,
          0.88,
          -1.64,
          0.504,
          -1.66
        ]
      },
      "strideX": 1,
      "strideY": 1
    }
```



### Example Input/Output Pair
Code from [LayerTestBase.java:120](../../../../../../../../../../MindsEye/src/test/java/com/simiacryptus/mindseye/layers/LayerTestBase.java#L120) executed in 0.00 seconds: 
```java
    SimpleEval eval = SimpleEval.run(layer, inputPrototype);
    return String.format("--------------------\nInput: \n[%s]\n--------------------\nOutput: \n%s",
      Arrays.stream(inputPrototype).map(t->t.prettyPrint()).reduce((a,b)->a+",\n"+b).get(),
      eval.getOutput().prettyPrint());
```

Returns: 

```
    --------------------
    Input: 
    [[
    	[ [ 1.832, -1.496, 1.508 ], [ 0.82, 1.976, -0.2 ], [ -0.408, -0.008, -0.34 ], [ -0.728, -1.372, 1.392 ], [ 1.556, 0.204, 1.684 ] ],
    	[ [ 0.94, -0.612, 1.02 ], [ 0.096, 0.936, -1.504 ], [ -1.596, -0.708, -0.232 ], [ 1.804, 1.816, 0.796 ], [ 1.1, 1.932, -0.332 ] ],
    	[ [ 1.116, 1.48, 1.464 ], [ -1.752, -1.048, -1.216 ], [ -0.512, 1.38, 1.5 ], [ -1.344, -0.56, -1.356 ], [ -0.564, -0.368, -0.528 ] ],
    	[ [ 1.176, 1.596, -1.912 ], [ -1.504, -0.188, 0.676 ], [ -0.168, 0.7, 0.392 ], [ -1.772, -1.008, -0.576 ], [ -1.656, -1.564, 1.996 ] ],
    	[ [ 0.36, 0.34, -0.06 ], [ 0.372, -1.512, -0.292 ], [ -1.236, 0.032, 0.264 ], [ 1.544, 0.136, 0.9 ], [ -0.516, 0.092, 1.3 ] ]
    ]]
    --------------------
    Output: 
    [
    	[ [ 0.1363040000000007, 3.833087999999999, 0.8948160000000008, -6.147888, 0.4403999999999997, 7.8832 ], [ -4.7934399999999995, 4.039520000000001, 9.740336, -1.8166079999999998, -5.182223999999999, -3.7947040000000003 ], [ 3.362288, -3.565552, -1.1102880000000002, 12.088655999999999, 3.080272000000001, -2.67504 ], [ 5.558752, 1.2704160000000004, -4.912704, -5.8005759999999995, -2.4834560000000003, 12.081408000000001 ], [ 0.9463199999999999, 4.018688000000002, 8.355376, 0.7464640000000003, -2.6438240000000004, 2.526768 ] ],
    	[ [ 3.813664, -10.58224, 5.930959999999999, -7.553952, -7.3228159999999995, 6.781376000000002 ], [ -10.469296, 6.802223999999999, 4.544240000000003, 16.24016, 2.286592, -19.960480000000004 ], [ 4.138576, -10.028767999999998, -3.80872, -12.839727999999997, 2.095648, 1.5496319999999997 ], [ -10.969248, 0.06188800000000005, 3.7647520000000014, 5.444608, 8.009456, 1.0967679999999997 ], [ -1.2173439999999998, -7.45024, -2.138608, 0.9681759999999996, -1.5798400000000001, -2.813808 ] ],
    	[ [ 4.820512, -6.4670559999999995, 4.965615999999999, 1.4130720000000003, -7.4312, 4.635007999999999 ], [ 1.864016, 0.49243200000000087, -1.9054880000000016, 2.488816000000001, -1.6272959999999987, -14.253647999999998 ], [ 0.8911359999999999, -9.804864, 4.651872, 2.201695999999999, 1.3991840000000004, 8.096176 ], [ -5.318576, 1.1755040000000005, -5.193856000000001, 5.114752, 8.832272000000001, -16.089184000000003 ], [ 0.43145600000000006, -4.9401280000000005, -3.953791999999999, -1.760864, 10.218768, 0.8152479999999994 ] ],
    	[ [ 2.0674879999999995, -7.9788640000000015, -5.633952, -0.782207999999999, 3.8069919999999997, -1.2426720000000004 ], [ 5.715743999999999, -4.487856, -3.046927999999998, -0.3318880000000004, -7.550864, -5.799632 ], [ 4.168512000000001, -4.448016000000001, -10.780304000000001, 3.979951999999999, 4.251919999999999, 7.0807839999999995 ], [ 8.698976000000002, -2.012863999999999, -2.0326239999999993, -11.660608000000003, -0.07027200000000111, -0.9460319999999994 ], [ 4.326351999999999, 4.227328, -2.0196159999999996, -0.6424319999999997, -0.18747199999999978, -0.9311360000000004 ] ],
    	[ [ -1.860368, -0.2821440000000001, 3.2685919999999995, -0.5328159999999998, 3.6010880000000007, -5.312032 ], [ 1.48536, -5.0587040000000005, 0.9567040000000001, 0.7448319999999999, 3.296976000000001, 6.650399999999999 ], [ 3.3494879999999996, 6.6119520000000005, -9.488608, -4.1523520000000005, 2.3654240000000013, -1.6849920000000003 ], [ -1.5023360000000001, -8.489584, 3.160176, -8.53536, 4.065632, 3.011264000000001 ], [ 4.200735999999999, 0.8064160000000001, -2.9449279999999987, -1.6428000000000005, -3.645184, 3.744592 ] ]
    ]
```



### Reference Implementation
Code from [LayerTestBase.java:131](../../../../../../../../../../MindsEye/src/test/java/com/simiacryptus/mindseye/layers/LayerTestBase.java#L131) executed in 0.02 seconds: 
```java
    System.out.println(new GsonBuilder().setPrettyPrinting().create().toJson(referenceLayer.getJson()));
    getEquivalencyTester().test(referenceLayer, layer, inputPrototype);
```
Logging: 
```
    {
      "class": "com.simiacryptus.mindseye.layers.aparapi.ConvolutionLayer",
      "id": "370a9587-74a1-4959-b406-fa45000014d3",
      "isFrozen": false,
      "name": "ConvolutionLayer/370a9587-74a1-4959-b406-fa45000014d3",
      "filter": {
        "dimensions": [
          3,
          3,
          18
        ],
        "data": [
          0.452,
          -0.328,
          -0.896,
          1.364,
          -1.216,
          -0.148,
          0.724,
          0.548,
          -0.42,
          1.188,
          1.724,
          1.932,
          0.924,
          -1.104,
          0.06,
          0.496,
          1.48,
          -0.612,
          -1.808,
          -0.372,
          1.528,
          -0.208,
          1.296,
          1.42,
          0.944,
          0.48,
          1.328,
          1.296,
          -0.4,
          1.288,
          -1.844,
          -0.344,
          -0.816,
          1.276,
          -0.12,
          0.932,
          -0.516,
          0.24,
          -0.16,
          -1.056,
          0.608,
          0.324,
          -1.712,
          -1.628,
          -1.4,
          1.628,
          0.772,
          -0.584,
          1.828,
          1.552,
          -1.332,
          -1.116,
          -1.208,
          -0.164,
          -0.204,
          -0.136,
          0.188,
          0.392,
          0.94,
          -0.288,
          0.248,
          1.024,
          1.704,
          0.516,
          0.956,
          -1.612,
          -1.896,
          -0.856,
          1.132,
          0.788,
          -1.692,
          0.136,
          1.18,
          -1.692,
          -1.02,
          0.128,
          0.632,
          -1.904,
          0.536,
          -0.464,
          0.832,
          1.504,
          -1.004,
          1.688,
          0.176,
          0.808,
          1.572,
          1.992,
          0.028,
          -1.676,
          0.972,
          -0.716,
          -0.988,
          -1.7,
          -0.488,
          1.616,
          1.616,
          -0.5,
          1.724,
          1.504,
          0.576,
          1.66,
          0.524,
          1.036,
          -1.34,
          -1.632,
          -0.88,
          1.932,
          0.74,
          0.34,
          -1.852,
          1.908,
          1.756,
          0.548,
          -1.0,
          -0.784,
          -0.188,
          0.62,
          -0.488,
          -1.688,
          -1.508,
          0.676,
          -1.556,
          1.808,
          1.372,
          -0.304,
          -1.088,
          -0.292,
          0.992,
          0.452,
          0.2,
          -1.516,
          0.34
```
...[skipping 150 bytes](etc/1.txt)...
```
    8,
          -0.544,
          0.192,
          0.984,
          -0.092,
          -1.18,
          0.884,
          0.228,
          0.728,
          -1.268,
          0.212,
          -0.548,
          -1.404,
          1.316,
          0.48,
          0.88,
          -1.64,
          0.504,
          -1.66
        ]
      },
      "skip": {
        "dimensions": [
          1,
          1
        ]
      },
      "simple": true
    }
    Inputs: [
    	[ [ 1.832, -1.496, 1.508 ], [ 0.82, 1.976, -0.2 ], [ -0.408, -0.008, -0.34 ], [ -0.728, -1.372, 1.392 ], [ 1.556, 0.204, 1.684 ] ],
    	[ [ 0.94, -0.612, 1.02 ], [ 0.096, 0.936, -1.504 ], [ -1.596, -0.708, -0.232 ], [ 1.804, 1.816, 0.796 ], [ 1.1, 1.932, -0.332 ] ],
    	[ [ 1.116, 1.48, 1.464 ], [ -1.752, -1.048, -1.216 ], [ -0.512, 1.38, 1.5 ], [ -1.344, -0.56, -1.356 ], [ -0.564, -0.368, -0.528 ] ],
    	[ [ 1.176, 1.596, -1.912 ], [ -1.504, -0.188, 0.676 ], [ -0.168, 0.7, 0.392 ], [ -1.772, -1.008, -0.576 ], [ -1.656, -1.564, 1.996 ] ],
    	[ [ 0.36, 0.34, -0.06 ], [ 0.372, -1.512, -0.292 ], [ -1.236, 0.032, 0.264 ], [ 1.544, 0.136, 0.9 ], [ -0.516, 0.092, 1.3 ] ]
    ]
    Error: [
    	[ [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ] ],
    	[ [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ] ],
    	[ [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ] ],
    	[ [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ] ],
    	[ [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ] ]
    ]
    Accuracy:
    absoluteTol: 0.0000e+00 +- 0.0000e+00 [0.0000e+00 - 0.0000e+00] (150#)
    relativeTol: 0.0000e+00 +- 0.0000e+00 [0.0000e+00 - 0.0000e+00] (150#)
    
```

### Batch Execution
Code from [LayerTestBase.java:138](../../../../../../../../../../MindsEye/src/test/java/com/simiacryptus/mindseye/layers/LayerTestBase.java#L138) executed in 0.04 seconds: 
```java
    BatchingTester batchingTester = getBatchingTester();
    return batchingTester==null?null:batchingTester.test(layer, inputPrototype);
```

Returns: 

```
    ToleranceStatistics{absoluteTol=4.6185e-17 +- 2.9453e-16 [0.0000e+00 - 3.5527e-15] (2250#), relativeTol=4.0477e-18 +- 2.5370e-17 [0.0000e+00 - 3.3541e-16] (2250#)}
```



### Differential Validation
Code from [LayerTestBase.java:144](../../../../../../../../../../MindsEye/src/test/java/com/simiacryptus/mindseye/layers/LayerTestBase.java#L144) executed in 1.95 seconds: 
```java
    return getDerivativeTester().test(layer, inputPrototype);
```
Logging: 
```
    Inputs: [
    	[ [ 1.832, -1.496, 1.508 ], [ 0.82, 1.976, -0.2 ], [ -0.408, -0.008, -0.34 ], [ -0.728, -1.372, 1.392 ], [ 1.556, 0.204, 1.684 ] ],
    	[ [ 0.94, -0.612, 1.02 ], [ 0.096, 0.936, -1.504 ], [ -1.596, -0.708, -0.232 ], [ 1.804, 1.816, 0.796 ], [ 1.1, 1.932, -0.332 ] ],
    	[ [ 1.116, 1.48, 1.464 ], [ -1.752, -1.048, -1.216 ], [ -0.512, 1.38, 1.5 ], [ -1.344, -0.56, -1.356 ], [ -0.564, -0.368, -0.528 ] ],
    	[ [ 1.176, 1.596, -1.912 ], [ -1.504, -0.188, 0.676 ], [ -0.168, 0.7, 0.392 ], [ -1.772, -1.008, -0.576 ], [ -1.656, -1.564, 1.996 ] ],
    	[ [ 0.36, 0.34, -0.06 ], [ 0.372, -1.512, -0.292 ], [ -1.236, 0.032, 0.264 ], [ 1.544, 0.136, 0.9 ], [ -0.516, 0.092, 1.3 ] ]
    ]
    Inputs Statistics: {meanExponent=-0.16233638417222218, negative=37, min=1.3, max=1.3, mean=0.09973333333333333, count=75.0, positive=38, stdDev=1.1372286938968004, zeros=0}
    Output: [
    	[ [ 0.1363040000000007, 3.833087999999999, 0.8948160000000008, -6.147888, 0.4403999999999997, 7.8832 ], [ -4.7934399999999995, 4.039520000000001, 9.740336, -1.8166079999999998, -5.182223999999999, -3.7947040000000003 ], [ 3.362288, -3.565552, -1.1102880000000002, 12.088655999999999, 3.080272000000001, -2.67504 ], [ 5.558752, 1.2704160000000004, -4.912704, -5.8005759999999995, -2.4834560000000003, 12.081408000000001 ], [ 0.9463199999999999, 4.018688000000002, 8.355376, 0.7464640000000003, -2.6438240000000004, 2.526768 ] ],
    	[ [ 3.813664, -10.58224, 5.930959999999999, -7.553952, -7.3228159999999995, 6.781376000000002 ], [ -10.469296, 6.802223999999999, 4.544240000000003, 16.24016, 2.286592, -19.960480000000004 ], [ 4.138576, -10.028767999999998, -3.80872, -12.839727999999997, 2.095648, 1.5496319999999997 ], [ -10.969248, 0.06188800000000005, 3.7647520000000014, 5.444608, 8.009456, 1.0967679999999997 ], [ -1.2173439999999998, -7.45024, -2.138608, 0.9681759999999996, -1.5798400000000001, -2.813808 ] ],
    	[ [ 4.820512, -6.4670559999999995, 4.965615999999999, 1.4130720000000003, -7.4312, 4.635007999999999 ], [ 1.864016, 0.49243200000000087, -1.9054880000000016, 2.48881600000
```
...[skipping 7663 bytes](etc/2.txt)...
```
    0, 0.0, 0.0, 0.0, 1.8319999999949488, 0.9399999999892827, 1.1160000000032255, ... ], ... ]
    Measured Statistics: {meanExponent=-0.14819469573500355, negative=1602, min=-0.5759999999987997, max=-0.5759999999987997, mean=0.002574814814781844, count=24300.0, positive=1440, stdDev=0.4042313717830107, zeros=21258}
    Gradient Error: [ [ -6.121242401846416E-12, 2.9107827259622354E-12, 1.1604051053382136E-12, 4.0357717168149065E-12, 0.0, -8.146372465489549E-12, 3.0406788198433787E-12, 8.49173509287482E-12, ... ], [ -8.452127886471317E-13, -1.68035030334579E-12, -1.5301093725383907E-12, 1.1604051053382136E-12, -4.051203816857196E-13, -7.291445225376947E-12, 7.354117315117037E-13, 3.0406788198433787E-12, ... ], [ 0.0, -8.452127886471317E-13, 2.760541795154836E-12, 7.351674824462862E-12, 1.1604051053382136E-12, 0.0, -7.291445225376947E-12, 7.354117315117037E-13, ... ], [ -1.8354207043103088E-12, -1.2154721673596214E-12, 2.73048250676311E-12, 5.911160450011721E-12, 0.0, -6.121242401846416E-12, -1.0411893569539643E-11, 1.1604051053382136E-12, ... ], [ -5.051292717439537E-12, -1.8354207043103088E-12, 3.2254199311410048E-12, 2.73048250676311E-12, -7.501776977392183E-13, -8.452127886471317E-13, 2.760541795154836E-12, 7.351674824462862E-12, ... ], [ 0.0, -6.104006189389111E-13, 7.0463634926909435E-12, 3.2254199311410048E-12, -1.7104095917375162E-12, 0.0, -9.726996985648384E-12, 2.760541795154836E-12, ... ], [ 0.0, 0.0, 0.0, 0.0, 0.0, -1.8354207043103088E-12, 3.2254199311410048E-12, 2.73048250676311E-12, ... ], [ 0.0, 0.0, 0.0, 0.0, 0.0, -5.051292717439537E-12, -1.0717204901311561E-11, 3.2254199311410048E-12, ... ], ... ]
    Error Statistics: {meanExponent=-11.710257510490036, negative=1514, min=1.2002621119222567E-12, max=1.2002621119222567E-12, mean=-3.2969497045577057E-14, count=24300.0, positive=1528, stdDev=1.7689906749852441E-12, zeros=21258}
    Finite-Difference Derivative Accuracy:
    absoluteTol: 5.8152e-13 +- 1.9898e-12 [0.0000e+00 - 3.3477e-11] (35550#)
    relativeTol: 5.4420e-12 +- 3.1052e-11 [1.5383e-15 - 1.4022e-09] (6084#)
    
```

Returns: 

```
    ToleranceStatistics{absoluteTol=5.8152e-13 +- 1.9898e-12 [0.0000e+00 - 3.3477e-11] (35550#), relativeTol=5.4420e-12 +- 3.1052e-11 [1.5383e-15 - 1.4022e-09] (6084#)}
```



### Performance
Code from [LayerTestBase.java:149](../../../../../../../../../../MindsEye/src/test/java/com/simiacryptus/mindseye/layers/LayerTestBase.java#L149) executed in 0.59 seconds: 
```java
    getPerformanceTester().test(layer, inputPrototype);
```
Logging: 
```
    Evaluation performance: 22.1995 +- 5.0218 [16.7568 - 41.1595]
    Learning performance: 12.4664 +- 17.8223 [9.3017 - 189.3970]
    
```

