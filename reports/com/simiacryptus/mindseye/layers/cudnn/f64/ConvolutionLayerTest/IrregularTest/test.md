# ConvolutionLayer
## IrregularTest
### Json Serialization
Code from [LayerTestBase.java:84](../../../../../../../../../../MindsEye/src/test/java/com/simiacryptus/mindseye/layers/LayerTestBase.java#L84) executed in 0.00 seconds: 
```java
    JsonObject json = layer.getJson();
    NNLayer echo = NNLayer.fromJson(json);
    assert (echo != null) : "Failed to deserialize";
    assert (layer != echo) : "Serialization did not copy";
    Assert.assertEquals("Serialization not equal", layer, echo);
    return new GsonBuilder().setPrettyPrinting().create().toJson(json);
```

Returns: 

```
    {
      "class": "com.simiacryptus.mindseye.layers.cudnn.f64.ConvolutionLayer",
      "id": "c88cbdf1-1c2a-4a5e-b964-890900000ae1",
      "isFrozen": false,
      "name": "ConvolutionLayer/c88cbdf1-1c2a-4a5e-b964-890900000ae1",
      "filter": {
        "dimensions": [
          1,
          1,
          6
        ],
        "data": [
          -1.832,
          0.896,
          1.552,
          0.012,
          1.62,
          0.524
        ]
      },
      "strideX": 1,
      "strideY": 1
    }
```



### Example Input/Output Pair
Code from [LayerTestBase.java:121](../../../../../../../../../../MindsEye/src/test/java/com/simiacryptus/mindseye/layers/LayerTestBase.java#L121) executed in 0.00 seconds: 
```java
    SimpleEval eval = SimpleEval.run(layer, inputPrototype);
    return String.format("--------------------\nInput: \n[%s]\n--------------------\nOutput: \n%s",
      Arrays.stream(inputPrototype).map(t->t.prettyPrint()).reduce((a,b)->a+",\n"+b).get(),
      eval.getOutput().prettyPrint());
```

Returns: 

```
    --------------------
    Input: 
    [[
    	[ [ 0.156, -1.02 ], [ -1.496, -1.276 ], [ -1.32, 0.208 ] ],
    	[ [ -0.532, 0.104 ], [ 1.488, 0.624 ], [ 1.312, -0.908 ] ],
    	[ [ 0.772, 0.14 ], [ 0.376, -0.288 ], [ -0.02, 1.34 ] ]
    ]]
    --------------------
    Output: 
    [
    	[ [ -0.29803199999999996, -1.5126240000000002, -0.292368 ], [ 2.72536, -3.4075360000000003, -2.9904159999999997 ], [ 2.420736, -0.84576, -1.9396480000000003 ] ],
    	[ [ 0.9758720000000001, -0.308192, -0.7711680000000001 ], [ -2.718528, 2.344128, 2.636352 ], [ -2.41448, -0.295408, 1.5604320000000003 ] ],
    	[ [ -1.412624, 0.918512, 1.2715040000000002 ], [ -0.692288, -0.12966399999999997, 0.4326400000000001 ], [ 0.05272, 2.15288, 0.67112 ] ]
    ]
```



### Reference Implementation
Code from [LayerTestBase.java:132](../../../../../../../../../../MindsEye/src/test/java/com/simiacryptus/mindseye/layers/LayerTestBase.java#L132) executed in 0.01 seconds: 
```java
    System.out.println(new GsonBuilder().setPrettyPrinting().create().toJson(referenceLayer.getJson()));
    getEquivalencyTester().test(referenceLayer, layer, inputPrototype);
```
Logging: 
```
    {
      "class": "com.simiacryptus.mindseye.layers.aparapi.ConvolutionLayer",
      "id": "c88cbdf1-1c2a-4a5e-b964-890900000aea",
      "isFrozen": false,
      "name": "ConvolutionLayer/c88cbdf1-1c2a-4a5e-b964-890900000aea",
      "filter": {
        "dimensions": [
          1,
          1,
          6
        ],
        "data": [
          -1.832,
          0.896,
          1.552,
          0.012,
          1.62,
          0.524
        ]
      },
      "skip": {
        "dimensions": [
          1,
          1
        ]
      },
      "simple": true
    }
    Inputs: [
    	[ [ 0.156, -1.02 ], [ -1.496, -1.276 ], [ -1.32, 0.208 ] ],
    	[ [ -0.532, 0.104 ], [ 1.488, 0.624 ], [ 1.312, -0.908 ] ],
    	[ [ 0.772, 0.14 ], [ 0.376, -0.288 ], [ -0.02, 1.34 ] ]
    ]
    Error: [
    	[ [ 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0 ] ],
    	[ [ 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0 ] ],
    	[ [ 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0 ] ]
    ]
    Accuracy:
    absoluteTol: 0.0000e+00 +- 0.0000e+00 [0.0000e+00 - 0.0000e+00] (27#)
    relativeTol: 0.0000e+00 +- 0.0000e+00 [0.0000e+00 - 0.0000e+00] (27#)
    
```

### Differential Validation
Code from [LayerTestBase.java:139](../../../../../../../../../../MindsEye/src/test/java/com/simiacryptus/mindseye/layers/LayerTestBase.java#L139) executed in 0.16 seconds: 
```java
    getDerivativeTester().test(layer, inputPrototype);
```
Logging: 
```
    Component: ConvolutionLayer/c88cbdf1-1c2a-4a5e-b964-890900000ae1
    Inputs: [
    	[ [ 0.156, -1.02 ], [ -1.496, -1.276 ], [ -1.32, 0.208 ] ],
    	[ [ -0.532, 0.104 ], [ 1.488, 0.624 ], [ 1.312, -0.908 ] ],
    	[ [ 0.772, 0.14 ], [ 0.376, -0.288 ], [ -0.02, 1.34 ] ]
    ]
    output=[
    	[ [ -0.29803199999999996, -1.5126240000000002, -0.292368 ], [ 2.72536, -3.4075360000000003, -2.9904159999999997 ], [ 2.420736, -0.84576, -1.9396480000000003 ] ],
    	[ [ 0.9758720000000001, -0.308192, -0.7711680000000001 ], [ -2.718528, 2.344128, 2.636352 ], [ -2.41448, -0.295408, 1.5604320000000003 ] ],
    	[ [ -1.412624, 0.918512, 1.2715040000000002 ], [ -0.692288, -0.12966399999999997, 0.4326400000000001 ], [ 0.05272, 2.15288, 0.67112 ] ]
    ]
    measured/actual: [ [ -1.8319999999999448, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.8960000000013402 ], [ 0.0, -1.8319999999993897, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, -1.8320000000016101, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, -1.8319999999993897, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, -1.8319999999993897, 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, -1.8320000000005, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.8319999999993897, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.8319999999993897, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.8319999999999448, 0.0 ], [ 0.011999999999789956, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.6199999999999548 ] ]
    implemented/expected: [ [ -1.832, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.896 ], [ 0.0, -1.832, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, -1.832, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, -1.832, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, -1.832, 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, -1.832, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.832, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.832, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.832, 0.0 ], [ 0.012, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.
```
...[skipping 1393 bytes](etc/1.txt)...
```
    0000002 ], [ -0.692288, -0.12966399999999997, 0.4326400000000001 ], [ 0.05272, 2.15288, 0.67112 ] ]
    ]
    Measured Gradient: [ [ 0.156000000000045, -0.5319999999997549, 0.7719999999999949, -1.4959999999986096, 1.4879999999983795, 0.3759999999997099, -1.3200000000024303, 1.3120000000022003, -0.019999999999950613, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.156000000000045 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ], [ -1.020000000000465, 0.10399999999965992, 0.14000000000180535, -1.2759999999989446, 0.62400000000018, -0.28799999999939985, 0.20800000000154029, -0.9080000000016852, 1.3399999999999523, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.0199999999982445 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ] ]
    Implemented Gradient: [ [ 0.156, -0.532, 0.772, -1.496, 1.488, 0.376, -1.32, 1.312, -0.02, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.156 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ], [ -1.02, 0.104, 0.14, -1.276, 0.624, -0.288, 0.208, -0.908, 1.34, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -1.02 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ] ]
    Error: [ [ 4.499178807293447E-14, 2.4513724383723456E-13, -5.10702591327572E-15, 1.390443316040546E-12, -1.6204815267428785E-12, -2.901012763345534E-13, -2.4302782009044677E-12, 2.2002399902021352E-12, 4.93875773610597E-14, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.499178807293447E-14 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ], [ -4.649614027130156E-13, -3.4007519023049326E-13, 1.805333660342967E-12, 1.0553780072086738E-12, 1.7996715229173788E-13, 6.001310559611284E-13, 1.5402956687893266E-12, -1.6852075290785251E-12, -4.773959005888173E-14, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.7554846465372975E-12 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ] ]
    Finite-Difference Derivative Accuracy:
    absoluteTol: 1.2755e-13 +- 4.6680e-13 [0.0000e+00 - 4.2211e-12] (648#)
    relativeTol: 5.3334e-12 +- 1.9435e-11 [3.3077e-15 - 1.0690e-10] (108#)
    
```

### Performance
Code from [LayerTestBase.java:144](../../../../../../../../../../MindsEye/src/test/java/com/simiacryptus/mindseye/layers/LayerTestBase.java#L144) executed in 0.30 seconds: 
```java
    getPerformanceTester().test(layer, inputPrototype);
```
Logging: 
```
    Evaluation performance: 10.1682 +- 0.6223 [9.3188 - 12.8184]
    Learning performance: 8.5573 +- 1.5198 [7.4323 - 16.5744]
    
```

