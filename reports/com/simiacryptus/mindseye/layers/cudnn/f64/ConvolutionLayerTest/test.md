# ConvolutionLayer
## ConvolutionLayerTest
### Json Serialization
Code from [LayerTestBase.java:83](../../../../../../../../src/test/java/com/simiacryptus/mindseye/layers/LayerTestBase.java#L83) executed in 0.00 seconds: 
```java
    JsonObject json = layer.getJson();
    NNLayer echo = NNLayer.fromJson(json);
    assert (echo != null) : "Failed to deserialize";
    assert (layer != echo) : "Serialization did not copy";
    Assert.assertEquals("Serialization not equal", layer, echo);
    return new GsonBuilder().setPrettyPrinting().create().toJson(json);
```

Returns: 

```
    {
      "class": "com.simiacryptus.mindseye.layers.cudnn.f64.ConvolutionLayer",
      "id": "a864e734-2f23-44db-97c1-50400000045e",
      "isFrozen": false,
      "name": "ConvolutionLayer/a864e734-2f23-44db-97c1-50400000045e",
      "filter": {
        "dimensions": [
          1,
          1,
          4
        ],
        "data": [
          0.924,
          1.932,
          -1.2,
          1.976
        ]
      },
      "strideX": 1,
      "strideY": 1
    }
```



### Example Input/Output Pair
Code from [LayerTestBase.java:120](../../../../../../../../src/test/java/com/simiacryptus/mindseye/layers/LayerTestBase.java#L120) executed in 0.00 seconds: 
```java
    SimpleEval eval = SimpleEval.run(layer, inputPrototype);
    return String.format("--------------------\nInput: \n[%s]\n--------------------\nOutput: \n%s",
      Arrays.stream(inputPrototype).map(t->t.prettyPrint()).reduce((a,b)->a+",\n"+b).get(),
      eval.getOutput().prettyPrint());
```

Returns: 

```
    --------------------
    Input: 
    [[
    	[ [ 1.24, -0.352 ], [ -0.248, 1.42 ], [ 1.212, -1.408 ], [ 0.652, 0.4 ], [ 1.696, 0.588 ] ],
    	[ [ -0.436, 0.2 ], [ -1.332, -1.616 ], [ -0.956, -0.2 ], [ 0.648, 1.56 ], [ 0.624, 0.38 ] ],
    	[ [ 1.68, 1.468 ], [ -1.696, -0.308 ], [ -1.852, -0.344 ], [ 1.248, 1.828 ], [ 0.16, 0.8 ] ],
    	[ [ -0.572, -0.604 ], [ -0.652, 0.744 ], [ -0.98, -0.592 ], [ 1.304, 0.872 ], [ -1.168, -0.548 ] ],
    	[ [ 0.376, 1.656 ], [ -1.084, -0.856 ], [ 1.668, 1.128 ], [ -1.112, 0.916 ], [ -0.024, -0.916 ] ]
    ]]
    --------------------
    Output: 
    [
    	[ [ 1.56816, 1.700128 ], [ -1.933152, 2.326784 ], [ 2.809488, -0.4406240000000001 ], [ 0.12244800000000008, 2.0500640000000003 ], [ 0.8615040000000002, 4.43856 ] ],
    	[ [ -0.642864, -0.447152 ], [ 0.708432, -5.766640000000001 ], [ -0.643344, -2.242192 ], [ -1.273248, 4.334496 ], [ 0.12057599999999999, 1.956448 ] ],
    	[ [ -0.20927999999999997, 6.146528 ], [ -1.1975040000000001, -3.8852799999999994 ], [ -1.298448, -4.257808 ], [ -1.040448, 6.023264 ], [ -0.81216, 1.88992 ] ],
    	[ [ 0.19627199999999995, -2.2986079999999998 ], [ -1.4952480000000001, 0.21047999999999986 ], [ -0.19512000000000004, -3.0631519999999997 ], [ 0.15849600000000022, 4.2424 ], [ -0.42163199999999995, -3.339424 ] ],
    	[ [ -1.639776, 3.9986879999999996 ], [ 0.02558399999999988, -3.785744 ], [ 0.1876320000000001, 5.451503999999999 ], [ -2.126688, -0.338368 ], [ 1.077024, -1.856384 ] ]
    ]
```



### Reference Implementation
Code from [LayerTestBase.java:131](../../../../../../../../src/test/java/com/simiacryptus/mindseye/layers/LayerTestBase.java#L131) executed in 0.02 seconds: 
```java
    System.out.println(new GsonBuilder().setPrettyPrinting().create().toJson(referenceLayer.getJson()));
    getEquivalencyTester().test(referenceLayer, layer, inputPrototype);
```
Logging: 
```
    {
      "class": "com.simiacryptus.mindseye.layers.aparapi.ConvolutionLayer",
      "id": "a864e734-2f23-44db-97c1-504000000465",
      "isFrozen": false,
      "name": "ConvolutionLayer/a864e734-2f23-44db-97c1-504000000465",
      "filter": {
        "dimensions": [
          1,
          1,
          4
        ],
        "data": [
          0.924,
          1.932,
          -1.2,
          1.976
        ]
      },
      "skip": {
        "dimensions": [
          1,
          1
        ]
      },
      "simple": true
    }
    Inputs: [
    	[ [ 1.24, -0.352 ], [ -0.248, 1.42 ], [ 1.212, -1.408 ], [ 0.652, 0.4 ], [ 1.696, 0.588 ] ],
    	[ [ -0.436, 0.2 ], [ -1.332, -1.616 ], [ -0.956, -0.2 ], [ 0.648, 1.56 ], [ 0.624, 0.38 ] ],
    	[ [ 1.68, 1.468 ], [ -1.696, -0.308 ], [ -1.852, -0.344 ], [ 1.248, 1.828 ], [ 0.16, 0.8 ] ],
    	[ [ -0.572, -0.604 ], [ -0.652, 0.744 ], [ -0.98, -0.592 ], [ 1.304, 0.872 ], [ -1.168, -0.548 ] ],
    	[ [ 0.376, 1.656 ], [ -1.084, -0.856 ], [ 1.668, 1.128 ], [ -1.112, 0.916 ], [ -0.024, -0.916 ] ]
    ]
    Error: [
    	[ [ 0.0, 0.0 ], [ 0.0, 0.0 ], [ 0.0, 0.0 ], [ 0.0, 0.0 ], [ 0.0, 0.0 ] ],
    	[ [ 0.0, 0.0 ], [ 0.0, 0.0 ], [ 0.0, 0.0 ], [ 0.0, 0.0 ], [ 0.0, 0.0 ] ],
    	[ [ 0.0, 0.0 ], [ 0.0, 0.0 ], [ 0.0, 0.0 ], [ 0.0, 0.0 ], [ 0.0, 0.0 ] ],
    	[ [ 0.0, 0.0 ], [ 0.0, 0.0 ], [ 0.0, 0.0 ], [ 0.0, 0.0 ], [ 0.0, 0.0 ] ],
    	[ [ 0.0, 0.0 ], [ 0.0, 0.0 ], [ 0.0, 0.0 ], [ 0.0, 0.0 ], [ 0.0, 0.0 ] ]
    ]
    Accuracy:
    absoluteTol: 0.0000e+00 +- 0.0000e+00 [0.0000e+00 - 0.0000e+00] (50#)
    relativeTol: 0.0000e+00 +- 0.0000e+00 [0.0000e+00 - 0.0000e+00] (50#)
    
```

### Batch Execution
Code from [LayerTestBase.java:138](../../../../../../../../src/test/java/com/simiacryptus/mindseye/layers/LayerTestBase.java#L138) executed in 0.02 seconds: 
```java
    BatchingTester batchingTester = getBatchingTester();
    return batchingTester==null?null:batchingTester.test(layer, inputPrototype);
```

Returns: 

```
    ToleranceStatistics{absoluteTol=0.0000e+00 +- 0.0000e+00 [0.0000e+00 - 0.0000e+00] (1000#), relativeTol=0.0000e+00 +- 0.0000e+00 [0.0000e+00 - 0.0000e+00] (1000#)}
```



### Differential Validation
Code from [LayerTestBase.java:144](../../../../../../../../src/test/java/com/simiacryptus/mindseye/layers/LayerTestBase.java#L144) executed in 0.29 seconds: 
```java
    return getDerivativeTester().test(layer, inputPrototype);
```
Logging: 
```
    Inputs: [
    	[ [ 1.24, -0.352 ], [ -0.248, 1.42 ], [ 1.212, -1.408 ], [ 0.652, 0.4 ], [ 1.696, 0.588 ] ],
    	[ [ -0.436, 0.2 ], [ -1.332, -1.616 ], [ -0.956, -0.2 ], [ 0.648, 1.56 ], [ 0.624, 0.38 ] ],
    	[ [ 1.68, 1.468 ], [ -1.696, -0.308 ], [ -1.852, -0.344 ], [ 1.248, 1.828 ], [ 0.16, 0.8 ] ],
    	[ [ -0.572, -0.604 ], [ -0.652, 0.744 ], [ -0.98, -0.592 ], [ 1.304, 0.872 ], [ -1.168, -0.548 ] ],
    	[ [ 0.376, 1.656 ], [ -1.084, -0.856 ], [ 1.668, 1.128 ], [ -1.112, 0.916 ], [ -0.024, -0.916 ] ]
    ]
    Inputs Statistics: {meanExponent=-0.13231335335111782, negative=24, min=-0.916, max=-0.916, mean=0.13224, count=50.0, positive=26, stdDev=1.048909043911816, zeros=0}
    Output: [
    	[ [ 1.56816, 1.700128 ], [ -1.933152, 2.326784 ], [ 2.809488, -0.4406240000000001 ], [ 0.12244800000000008, 2.0500640000000003 ], [ 0.8615040000000002, 4.43856 ] ],
    	[ [ -0.642864, -0.447152 ], [ 0.708432, -5.766640000000001 ], [ -0.643344, -2.242192 ], [ -1.273248, 4.334496 ], [ 0.12057599999999999, 1.956448 ] ],
    	[ [ -0.20927999999999997, 6.146528 ], [ -1.1975040000000001, -3.8852799999999994 ], [ -1.298448, -4.257808 ], [ -1.040448, 6.023264 ], [ -0.81216, 1.88992 ] ],
    	[ [ 0.19627199999999995, -2.2986079999999998 ], [ -1.4952480000000001, 0.21047999999999986 ], [ -0.19512000000000004, -3.0631519999999997 ], [ 0.15849600000000022, 4.2424 ], [ -0.42163199999999995, -3.339424 ] ],
    	[ [ -1.639776, 3.9986879999999996 ], [ 0.02558399999999988, -3.785744 ], [ 0.1876320000000001, 5.451503999999999 ], [ -2.126688, -0.338368 ], [ 1.077024, -1.856384 ] ]
    ]
    Outputs Statistics: {meanExponent=0.057513776183015695, negative=26, min=-1.856384, max=-1.856384, mean=0.11909183999999995, count=50.0, positive=24, stdDev=2.6258221214818294, zeros=0}
    Feedback for input 0
    Inputs Values: [
    	[ [ 1.24, -0.352 ], [ -0.248, 1.42 ], [ 1.212, -1.408 ], [ 0.652, 0.4 ], [ 1.696, 0.588 ] ],
    	[ [ -0.436, 0.2 ], [ -1.332, -1.616 ], [ -0.956, -0.2 ], [ 0.648, 1.56 ], [ 0.624, 0.38 ] ],
    	[ [ 1.68, 1.468 ], [ -1.696, -0.308 ], [ -1.852, -0.344 ], [ 1.248, 1.828 ], [ 0.16, 0.8 ] ],
    	[
```
...[skipping 2597 bytes](etc/1.txt)...
```
    976 ]
    Implemented Gradient: [ [ 1.24, -0.436, 1.68, -0.572, 0.376, -0.248, -1.332, -1.696, ... ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ... ], [ -0.352, 0.2, 1.468, -0.604, 1.656, 1.42, -1.616, -0.308, ... ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ... ] ]
    Implemented Statistics: {meanExponent=-0.13231335335111774, negative=48, min=-0.916, max=-0.916, mean=0.06612000000000003, count=200.0, positive=52, stdDev=0.7446320874096146, zeros=100}
    Measured Gradient: [ [ 1.2400000000001299, -0.436000000000325, 1.6800000000016801, -0.5719999999997949, 0.37600000000193035, -0.24799999999824962, -1.332000000000555, -1.6959999999999198, ... ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ... ], [ -0.35199999999901976, 0.20000000000020002, 1.4679999999997473, -0.6039999999998824, 1.65600000000099, 1.420000000000865, -1.6159999999998398, -0.30799999999997496, ... ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ... ] ]
    Measured Statistics: {meanExponent=-0.13231335335089736, negative=48, min=-0.9159999999996948, max=-0.9159999999996948, mean=0.06612000000008889, count=200.0, positive=52, stdDev=0.7446320874096025, zeros=100}
    Gradient Error: [ [ 1.2989609388114332E-13, -3.250177904590146E-13, 1.680211525467712E-12, 2.0505819264826641E-13, 1.9303447729157597E-12, 1.7503776206240218E-12, -5.548894677076532E-13, 8.01581023779363E-14, ... ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ... ], [ 9.802159084415507E-13, 2.0000667788622195E-13, -2.5268676040468563E-13, 1.1757261830780408E-13, 9.900968933607146E-13, 8.65085780787922E-13, 1.603162047558726E-13, 2.503552920529728E-14, ... ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ... ] ]
    Error Statistics: {meanExponent=-12.222859675192208, negative=43, min=3.0520030946945553E-13, max=3.0520030946945553E-13, mean=8.888896563252757E-14, count=200.0, positive=57, stdDev=1.4418501666971369E-12, zeros=100}
    Finite-Difference Derivative Accuracy:
    absoluteTol: 7.4165e-14 +- 4.6758e-13 [0.0000e+00 - 7.9714e-12] (2700#)
    relativeTol: 7.0522e-13 +- 1.6961e-12 [9.5316e-15 - 1.4378e-11] (200#)
    
```

Returns: 

```
    ToleranceStatistics{absoluteTol=7.4165e-14 +- 4.6758e-13 [0.0000e+00 - 7.9714e-12] (2700#), relativeTol=7.0522e-13 +- 1.6961e-12 [9.5316e-15 - 1.4378e-11] (200#)}
```



### Performance
Code from [LayerTestBase.java:149](../../../../../../../../src/test/java/com/simiacryptus/mindseye/layers/LayerTestBase.java#L149) executed in 0.28 seconds: 
```java
    getPerformanceTester().test(layer, inputPrototype);
```
Logging: 
```
    Evaluation performance: 9.8486 +- 1.2097 [8.6491 - 17.0873]
    Learning performance: 7.1967 +- 1.3022 [5.6768 - 13.1945]
    
```

