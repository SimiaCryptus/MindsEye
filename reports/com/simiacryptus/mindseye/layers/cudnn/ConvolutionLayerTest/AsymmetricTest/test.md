# ConvolutionLayer
## AsymmetricTest
### Json Serialization
Code from [StandardLayerTests.java:68](../../../../../../../../src/main/java/com/simiacryptus/mindseye/test/StandardLayerTests.java#L68) executed in 0.00 seconds: 
```java
    JsonObject json = layer.getJson();
    NNLayer echo = NNLayer.fromJson(json);
    if ((echo == null)) throw new AssertionError("Failed to deserialize");
    if ((layer == echo)) throw new AssertionError("Serialization did not copy");
    if ((!layer.equals(echo))) throw new AssertionError("Serialization not equal");
    return new GsonBuilder().setPrettyPrinting().create().toJson(json);
```

Returns: 

```
    {
      "class": "com.simiacryptus.mindseye.layers.cudnn.ConvolutionLayer",
      "id": "a1efb079-0cfd-4e46-8f72-7d6000e3b745",
      "isFrozen": false,
      "name": "ConvolutionLayer/a1efb079-0cfd-4e46-8f72-7d6000e3b745",
      "filter": [
        [
          [
            -1.056,
            -1.664,
            -0.268
          ],
          [
            0.276,
            1.276,
            -0.276
          ],
          [
            -0.508,
            1.976,
            0.616
          ]
        ],
        [
          [
            -1.96,
            -0.576,
            -0.18
          ],
          [
            0.8,
            1.472,
            -1.192
          ],
          [
            -1.832,
            -0.272,
            -1.204
          ]
        ],
        [
          [
            0.156,
            -1.856,
            1.24
          ],
          [
            0.244,
            1.192,
            -1.228
          ],
          [
            0.188,
            -1.032,
            -0.2
          ]
        ],
        [
          [
            0.392,
            -1.712,
            0.164
          ],
          [
            1.328,
            -1.952,
            -0.14
          ],
          [
            -0.348,
            -1.184,
            -0.712
          ]
        ],
        [
      
```
...[skipping 1754 bytes](etc/49.txt)...
```
     ]
        ],
        [
          [
            -1.224,
            -1.336,
            -0.54
          ],
          [
            -1.956,
            1.884,
            0.448
          ],
          [
            -1.972,
            1.104,
            0.024
          ]
        ],
        [
          [
            1.644,
            -1.396,
            0.184
          ],
          [
            -0.176,
            -1.42,
            -0.892
          ],
          [
            1.724,
            0.14,
            -0.012
          ]
        ],
        [
          [
            -0.76,
            0.576,
            1.94
          ],
          [
            0.46,
            -0.56,
            0.64
          ],
          [
            0.8,
            1.1,
            0.74
          ]
        ],
        [
          [
            1.188,
            -0.02,
            -0.032
          ],
          [
            1.04,
            0.74,
            -0.124
          ],
          [
            1.172,
            0.184,
            -0.028
          ]
        ],
        [
          [
            -1.068,
            -1.608,
            1.756
          ],
          [
            0.864,
            -0.26,
            -0.624
          ],
          [
            -0.696,
            1.296,
            -0.4
          ]
        ]
      ],
      "strideX": 1,
      "strideY": 1
    }
```



### Example Input/Output Pair
Code from [StandardLayerTests.java:152](../../../../../../../../src/main/java/com/simiacryptus/mindseye/test/StandardLayerTests.java#L152) executed in 0.01 seconds: 
```java
    SimpleEval eval = SimpleEval.run(layer, inputPrototype);
    return String.format("--------------------\nInput: \n[%s]\n--------------------\nOutput: \n%s\n--------------------\nDerivative: \n%s",
      Arrays.stream(inputPrototype).map(t -> t.prettyPrint()).reduce((a, b) -> a + ",\n" + b).get(),
      eval.getOutput().prettyPrint(),
      Arrays.stream(eval.getDerivative()).map(t -> t.prettyPrint()).reduce((a, b) -> a + ",\n" + b).get());
```

Returns: 

```
    --------------------
    Input: 
    [[
    	[ [ 1.82, 1.704, 1.888 ], [ -1.004, 0.88, -0.768 ], [ 0.06, -1.552, -1.208 ], [ 0.184, 1.052, 0.604 ], [ 1.728, -0.968, 0.384 ] ],
    	[ [ -1.54, 1.46, -0.196 ], [ -0.588, 0.852, -1.26 ], [ 1.936, 0.256, -1.884 ], [ -1.812, 1.352, -1.688 ], [ 0.328, 0.12, -0.92 ] ],
    	[ [ -0.932, 0.252, -0.516 ], [ -1.904, 1.36, 0.636 ], [ 1.608, -0.976, 0.512 ], [ -1.408, -0.832, -1.508 ], [ 1.224, 0.056, -1.064 ] ],
    	[ [ 1.404, -0.724, -1.276 ], [ -1.74, -1.268, -1.532 ], [ 1.436, -0.88, 1.26 ], [ -1.748, 0.076, -1.924 ], [ 1.164, 0.456, -0.744 ] ],
    	[ [ 0.168, -0.836, -1.592 ], [ 1.12, 1.568, 1.604 ], [ 0.048, -1.808, 0.512 ], [ 0.448, -1.48, 0.552 ], [ 0.988, 1.232, -1.776 ] ]
    ]]
    --------------------
    Output: 
    [
    	[ [ 2.273744, 10.153424, 0.7963039999999998, -3.3354719999999998, 5.769360000000001, 7.611039999999998 ], [ -0.11979199999999958, 6.116672000000001, -10.61736, 1.6728800000000001, -13.034208, 12.725888 ], [ 2.9656320000000016, 13.734496000000002, -6.607584, 2.0154880000000004, -7.33870
```
...[skipping 2842 bytes](etc/50.txt)...
```
    .3199999999999985 ], [ -15.243999999999996, 9.303999999999998, 5.32 ], [ -15.243999999999996, 9.304000000000002, 5.3199999999999985 ], [ -6.443999999999998, 14.352000000000002, -3.7159999999999993 ] ],
    	[ [ -9.919999999999998, -0.4039999999999999, 6.687999999999999 ], [ -15.243999999999998, 9.303999999999998, 5.3199999999999985 ], [ -15.243999999999996, 9.303999999999998, 5.32 ], [ -15.243999999999996, 9.304000000000002, 5.3199999999999985 ], [ -6.443999999999998, 14.352000000000002, -3.7159999999999993 ] ],
    	[ [ -9.919999999999998, -0.4039999999999999, 6.688 ], [ -15.243999999999998, 9.303999999999998, 5.3199999999999985 ], [ -15.243999999999996, 9.303999999999998, 5.32 ], [ -15.243999999999996, 9.304000000000002, 5.3199999999999985 ], [ -6.443999999999998, 14.352000000000002, -3.716000000000001 ] ],
    	[ [ -0.9559999999999977, -1.2640000000000002, 6.916 ], [ -8.776, 8.427999999999999, 3.952 ], [ -8.776, 8.428, 3.951999999999999 ], [ -8.776, 8.428, 3.9519999999999995 ], [ -3.768, 10.7, -3.928000000000001 ] ]
    ]
```



[GPU Log](etc/cuda.log)

### Reference Implementation
Code from [StandardLayerTests.java:92](../../../../../../../../src/main/java/com/simiacryptus/mindseye/test/StandardLayerTests.java#L92) executed in 0.02 seconds: 
```java
    System.out.println(new GsonBuilder().setPrettyPrinting().create().toJson(referenceLayer.getJson()));
    getEquivalencyTester().test(referenceLayer, layer, inputPrototype);
```
Logging: 
```
    {
      "class": "com.simiacryptus.mindseye.layers.aparapi.ConvolutionLayer",
      "id": "c379b2aa-c6ac-43ed-88b1-fbe10b98e529",
      "isFrozen": false,
      "name": "ConvolutionLayer/c379b2aa-c6ac-43ed-88b1-fbe10b98e529",
      "filter": [
        [
          [
            -1.056,
            -1.664,
            -0.268
          ],
          [
            0.276,
            1.276,
            -0.276
          ],
          [
            -0.508,
            1.976,
            0.616
          ]
        ],
        [
          [
            -1.96,
            -0.576,
            -0.18
          ],
          [
            0.8,
            1.472,
            -1.192
          ],
          [
            -1.832,
            -0.272,
            -1.204
          ]
        ],
        [
          [
            0.156,
            -1.856,
            1.24
          ],
          [
            0.244,
            1.192,
            -1.228
          ],
          [
            0.188,
            -1.032,
            -0.2
          ]
        ],
        [
          [
            0.392,
            -1.712,
            0.164
          ],
          [
            1.328,
            -1.952,
            -0.14
          ],
          [
            -0.348,
            -1.184,
            -0.712
          ]
        ],
        [
```
...[skipping 3510 bytes](etc/51.txt)...
```
    , 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ] ],
    	[ [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ] ],
    	[ [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ] ],
    	[ [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ] ],
    	[ [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ] ]
    ]
    Accuracy:
    absoluteTol: 0.0000e+00 +- 0.0000e+00 [0.0000e+00 - 0.0000e+00] (150#)
    relativeTol: 0.0000e+00 +- 0.0000e+00 [0.0000e+00 - 0.0000e+00] (150#)
    
```

### Batch Execution
Code from [StandardLayerTests.java:101](../../../../../../../../src/main/java/com/simiacryptus/mindseye/test/StandardLayerTests.java#L101) executed in 0.03 seconds: 
```java
    return getBatchingTester().test(layer, inputPrototype);
```

Returns: 

```
    ToleranceStatistics{absoluteTol=2.3685e-17 +- 2.4728e-16 [0.0000e+00 - 3.5527e-15] (2250#), relativeTol=1.2642e-18 +- 1.3583e-17 [0.0000e+00 - 1.9092e-16] (2250#)}
```



### Differential Validation
Code from [StandardLayerTests.java:109](../../../../../../../../src/main/java/com/simiacryptus/mindseye/test/StandardLayerTests.java#L109) executed in 1.03 seconds: 
```java
    return getDerivativeTester().test(layer, inputPrototype);
```
Logging: 
```
    Inputs: [
    	[ [ 1.736, 0.316, 0.244 ], [ 0.208, 1.824, -1.044 ], [ 0.144, -0.728, 0.028 ], [ 1.848, -0.04, -1.324 ], [ -1.628, 0.696, -0.96 ] ],
    	[ [ 1.408, 1.636, 0.304 ], [ -0.752, -0.14, -0.464 ], [ -1.648, 1.892, 1.384 ], [ -0.72, -0.584, 1.492 ], [ -0.86, 0.708, 0.268 ] ],
    	[ [ -0.864, -0.04, 0.936 ], [ 1.532, -1.252, -1.796 ], [ 0.304, -0.328, -0.216 ], [ -0.144, 1.344, 0.604 ], [ -0.248, -0.148, -1.148 ] ],
    	[ [ 0.528, -0.66, 1.892 ], [ 0.948, 0.088, 0.0 ], [ -0.516, 1.32, 0.224 ], [ -1.292, -0.772, 0.88 ], [ -0.212, 1.496, 0.58 ] ],
    	[ [ 0.776, 1.964, -1.164 ], [ 0.844, 1.44, 0.96 ], [ -1.448, 1.372, -0.94 ], [ 1.396, 1.576, -0.304 ], [ -0.34, -0.852, -1.752 ] ]
    ]
    Inputs Statistics: {meanExponent=-0.19295790568977111, negative=35, min=-1.752, max=-1.752, mean=0.15749333333333346, count=75.0, positive=39, stdDev=1.0459743830302708, zeros=1}
    Output: [
    	[ [ 0.008640000000000375, 6.540704000000002, 3.935152, -1.3096319999999997, 1.2397120000000004, 7.58944 ], [ 5.095007999999999, -0.6869760000000003, -2.
```
...[skipping 9811 bytes](etc/52.txt)...
```
    960489265E-12, ... ], [ 1.0700329511337259E-12, -3.920863633766203E-12, -7.081335517966636E-12, -2.580602398438714E-12, 1.099120794378905E-13, -2.9005964297112996E-12, -1.2742473742832772E-11, 6.306066779870889E-12, ... ], [ 0.0, 1.0700329511337259E-12, -1.2802647830767455E-11, 1.8004486790346164E-12, 1.8602897000619123E-12, 0.0, -2.9005964297112996E-12, 5.021094651169733E-12, ... ], [ 0.0, 0.0, 0.0, 0.0, 0.0, -3.920863633766203E-12, -7.081335517966636E-12, 6.3011817985625385E-12, ... ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 1.0700329511337259E-12, -1.2802647830767455E-11, 1.8004486790346164E-12, ... ], ... ]
    Error Statistics: {meanExponent=-11.814844985044878, negative=1618, min=-2.3014923300479495E-13, max=-2.3014923300479495E-13, mean=-1.2130909559907044E-14, count=24300.0, positive=1370, stdDev=1.397510780729054E-12, zeros=21312}
    Finite-Difference Derivative Accuracy:
    absoluteTol: 4.7753e-13 +- 1.5497e-12 [0.0000e+00 - 1.7483e-11] (35550#)
    relativeTol: 4.9356e-12 +- 1.4186e-11 [1.2910e-15 - 2.9193e-10] (6030#)
    
```

Returns: 

```
    ToleranceStatistics{absoluteTol=4.7753e-13 +- 1.5497e-12 [0.0000e+00 - 1.7483e-11] (35550#), relativeTol=4.9356e-12 +- 1.4186e-11 [1.2910e-15 - 2.9193e-10] (6030#)}
```



### Performance
Code from [StandardLayerTests.java:119](../../../../../../../../src/main/java/com/simiacryptus/mindseye/test/StandardLayerTests.java#L119) executed in 1.79 seconds: 
```java
    getPerformanceTester().test(layer, permPrototype);
```
Logging: 
```
    100 batches
    Input Dimensions:
    	[100, 100, 3]
    Performance:
    	Evaluation performance: 0.071538s +- 0.015624s [0.048012s - 0.087981s]
    	Learning performance: 0.221626s +- 0.079590s [0.160489s - 0.368992s]
    
```

