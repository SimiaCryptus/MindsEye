# ConvolutionLayer
## IrregularTest
### Json Serialization
Code from [StandardLayerTests.java:69](../../../../../../../../src/main/java/com/simiacryptus/mindseye/test/StandardLayerTests.java#L69) executed in 0.00 seconds: 
```java
    JsonObject json = layer.getJson();
    NNLayer echo = NNLayer.fromJson(json);
    if ((echo == null)) throw new AssertionError("Failed to deserialize");
    if ((layer == echo)) throw new AssertionError("Serialization did not copy");
    if ((!layer.equals(echo))) throw new AssertionError("Serialization not equal");
    return new GsonBuilder().setPrettyPrinting().create().toJson(json);
```

Returns: 

```
    {
      "class": "com.simiacryptus.mindseye.layers.cudnn.ConvolutionLayer",
      "id": "310cfa0f-a35d-48bc-8ac6-81de862a250d",
      "isFrozen": false,
      "name": "ConvolutionLayer/310cfa0f-a35d-48bc-8ac6-81de862a250d",
      "filter": [
        [
          [
            -0.988,
            1.38,
            -0.228
          ],
          [
            -0.12,
            -1.048,
            -1.948
          ],
          [
            0.764,
            -0.308,
            0.808
          ]
        ],
        [
          [
            -0.628,
            -1.96,
            1.792
          ],
          [
            -1.94,
            1.672,
            1.42
          ],
          [
            -1.836,
            0.564,
            0.36
          ]
        ],
        [
          [
            -0.172,
            -1.44,
            0.964
          ],
          [
            -1.936,
            -1.68,
            -1.56
          ],
          [
            1.296,
            -0.112,
            -1.468
          ]
        ],
        [
          [
            0.312,
            0.472,
            -0.516
          ],
          [
            1.916,
            -1.22,
            -0.768
          ],
          [
            0.852,
            -1.18,
            -1.008
          ]
        ],
        [
         
```
...[skipping 5125 bytes](etc/21.txt)...
```
    
        [
          [
            -1.612,
            1.728,
            -0.628
          ],
          [
            0.932,
            0.648,
            -0.912
          ],
          [
            -0.048,
            0.436,
            1.368
          ]
        ],
        [
          [
            1.76,
            0.736,
            0.552
          ],
          [
            -0.348,
            0.156,
            0.236
          ],
          [
            -0.54,
            -1.06,
            -1.692
          ]
        ],
        [
          [
            -0.716,
            -0.728,
            1.72
          ],
          [
            -1.552,
            -0.316,
            0.208
          ],
          [
            -1.572,
            -0.56,
            -1.716
          ]
        ],
        [
          [
            -0.48,
            1.256,
            0.752
          ],
          [
            -0.824,
            0.744,
            1.684
          ],
          [
            -0.464,
            1.576,
            1.908
          ]
        ],
        [
          [
            -0.584,
            1.284,
            1.404
          ],
          [
            0.528,
            0.4,
            0.856
          ],
          [
            -1.952,
            0.644,
            1.988
          ]
        ]
      ],
      "strideX": 1,
      "strideY": 1
    }
```



### Example Input/Output Pair
Code from [StandardLayerTests.java:153](../../../../../../../../src/main/java/com/simiacryptus/mindseye/test/StandardLayerTests.java#L153) executed in 0.00 seconds: 
```java
    SimpleEval eval = SimpleEval.run(layer, inputPrototype);
    return String.format("--------------------\nInput: \n[%s]\n--------------------\nOutput: \n%s\n--------------------\nDerivative: \n%s",
      Arrays.stream(inputPrototype).map(t -> t.prettyPrint()).reduce((a, b) -> a + ",\n" + b).get(),
      eval.getOutput().prettyPrint(),
      Arrays.stream(eval.getDerivative()).map(t -> t.prettyPrint()).reduce((a, b) -> a + ",\n" + b).get());
```

Returns: 

```
    --------------------
    Input: 
    [[
    	[ [ -1.992, 0.564, -1.944, -0.332, -1.56, 1.812, 0.464 ], [ 0.268, 1.776, 1.576, 0.092, -0.572, 0.996, 0.12 ], [ 0.132, -1.688, 0.796, 1.628, 0.676, -0.572, -1.468 ], [ -1.248, 1.124, -1.9, 1.116, 0.836, 0.508, 0.908 ], [ 1.768, -1.244, 0.28, 0.032, 1.424, -0.608, -1.192 ] ],
    	[ [ 1.596, -0.268, -0.024, -1.644, 1.78, 1.676, 1.864 ], [ 1.968, -0.376, 1.952, -1.976, 1.3, 0.488, -0.752 ], [ 1.592, 0.624, -1.128, -1.336, 1.928, -1.1, 0.152 ], [ 1.972, -0.348, -0.704, -1.88, 0.688, -0.74, 0.824 ], [ -1.264, -1.32, -0.088, -1.364, 1.268, 1.536, 0.94 ] ],
    	[ [ -1.188, -0.176, 0.896, -1.824, -0.808, 0.588, 0.172 ], [ -0.56, -0.112, -1.684, -0.332, -1.324, -0.772, 0.784 ], [ 1.136, 1.724, 1.644, -0.016, 0.92, 0.42, -1.696 ], [ 0.172, 1.728, 0.66, -1.432, 0.996, -0.612, 0.908 ], [ 0.384, -1.316, -1.064, 1.904, 0.688, -1.376, -0.124 ] ],
    	[ [ 0.076, -1.416, -0.356, 1.38, 0.804, 0.74, 1.34 ], [ 0.276, 0.356, -1.272, 0.552, -1.124, 1.376, 1.3 ], [ 1.028, 0.272, 1.676, 0.948, -0.476, 1.18, 
```
...[skipping 4348 bytes](etc/22.txt)...
```
    -3.363999999999999, 8.884 ] ],
    	[ [ -11.072, 7.364, -10.488, -5.8359999999999985, -5.236, 8.996, 0.7559999999999993 ], [ -13.768, 8.016, -13.188, -6.823999999999998, -5.984000000000001, 0.9800000000000009, 7.199999999999999 ], [ -13.767999999999999, 8.016, -13.188, -6.823999999999998, -5.984000000000002, 0.9800000000000009, 7.199999999999999 ], [ -13.767999999999999, 8.016, -13.188, -6.823999999999998, -5.984, 0.9800000000000009, 7.1999999999999975 ], [ -10.536, 6.5840000000000005, -6.764, -3.1559999999999993, -4.272000000000001, -3.363999999999999, 8.884 ] ],
    	[ [ -6.348, 7.712, -5.9, 3.2680000000000002, -5.24, 9.784, -3.172 ], [ -10.0, 8.856, -9.36, 4.728, -4.748000000000001, 3.980000000000001, -0.5280000000000005 ], [ -9.999999999999998, 8.856, -9.36, 4.728, -4.748000000000001, 3.980000000000001, -0.5280000000000005 ], [ -10.0, 8.856, -9.36, 4.728, -4.748000000000001, 3.980000000000001, -0.5280000000000005 ], [ -9.556, 6.5920000000000005, -6.596, 4.248, -0.8680000000000008, -1.1039999999999992, 3.012 ] ]
    ]
```



[GPU Log](etc/cuda.log)

### Reference Implementation
Code from [StandardLayerTests.java:93](../../../../../../../../src/main/java/com/simiacryptus/mindseye/test/StandardLayerTests.java#L93) executed in 0.02 seconds: 
```java
    System.out.println(new GsonBuilder().setPrettyPrinting().create().toJson(referenceLayer.getJson()));
    getEquivalencyTester().test(referenceLayer, layer, inputPrototype);
```
Logging: 
```
    {
      "class": "com.simiacryptus.mindseye.layers.aparapi.ConvolutionLayer",
      "id": "d6f3ca06-4804-4b7e-9cec-f76a14fe7e67",
      "isFrozen": false,
      "name": "ConvolutionLayer/d6f3ca06-4804-4b7e-9cec-f76a14fe7e67",
      "filter": [
        [
          [
            -0.988,
            1.38,
            -0.228
          ],
          [
            -0.12,
            -1.048,
            -1.948
          ],
          [
            0.764,
            -0.308,
            0.808
          ]
        ],
        [
          [
            -0.628,
            -1.96,
            1.792
          ],
          [
            -1.94,
            1.672,
            1.42
          ],
          [
            -1.836,
            0.564,
            0.36
          ]
        ],
        [
          [
            -0.172,
            -1.44,
            0.964
          ],
          [
            -1.936,
            -1.68,
            -1.56
          ],
          [
            1.296,
            -0.112,
            -1.468
          ]
        ],
        [
          [
            0.312,
            0.472,
            -0.516
          ],
          [
            1.916,
            -1.22,
            -0.768
          ],
          [
            0.852,
            -1.18,
            -1.008
          ]
        ],
        [
       
```
...[skipping 7469 bytes](etc/23.txt)...
```
    , 1.34, -1.008, -1.748, 0.736, -0.152, 0.952 ], [ -0.388, 0.176, -0.324, 1.884, -0.328, 1.488, 1.952 ] ]
    ]
    Error: [
    	[ [ 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0 ] ],
    	[ [ 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0 ] ],
    	[ [ 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0 ] ],
    	[ [ 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0 ] ],
    	[ [ 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0 ], [ 0.0, 0.0, 0.0, 0.0, 0.0 ] ]
    ]
    Accuracy:
    absoluteTol: 0.0000e+00 +- 0.0000e+00 [0.0000e+00 - 0.0000e+00] (125#)
    relativeTol: 0.0000e+00 +- 0.0000e+00 [0.0000e+00 - 0.0000e+00] (125#)
    
```

### Batch Execution
Code from [StandardLayerTests.java:102](../../../../../../../../src/main/java/com/simiacryptus/mindseye/test/StandardLayerTests.java#L102) executed in 0.02 seconds: 
```java
    return getBatchingTester().test(layer, inputPrototype);
```

Returns: 

```
    ToleranceStatistics{absoluteTol=3.1974e-17 +- 2.2968e-16 [0.0000e+00 - 3.5527e-15] (3000#), relativeTol=3.8966e-18 +- 2.5840e-17 [0.0000e+00 - 4.2054e-16] (3000#)}
```



### Differential Validation
Code from [StandardLayerTests.java:110](../../../../../../../../src/main/java/com/simiacryptus/mindseye/test/StandardLayerTests.java#L110) executed in 1.10 seconds: 
```java
    return getDerivativeTester().test(layer, inputPrototype);
```
Logging: 
```
    Inputs: [
    	[ [ 1.368, 1.596, 1.772, 0.156, -0.404, 0.932, -0.152 ], [ -1.076, 0.528, -0.82, -1.8, -1.924, -0.772, 0.612 ], [ -0.932, 1.852, 0.476, -1.872, 0.176, -0.328, 0.816 ], [ 0.648, 1.788, -0.148, -1.12, 1.776, -0.896, 0.46 ], [ -0.804, -1.588, 1.964, -0.28, 0.16, 0.8, 0.32 ] ],
    	[ [ 1.888, -0.94, 1.604, 1.096, 1.528, 0.524, 1.788 ], [ -1.408, -1.392, -0.86, -1.592, 0.732, -1.104, -1.228 ], [ -1.508, 1.084, -0.824, -0.968, -1.74, 0.852, -1.752 ], [ -1.628, 1.508, 0.6, -1.672, -1.576, 1.336, -0.708 ], [ -0.528, -1.376, -0.18, -1.1, 0.108, 1.9, -1.012 ] ],
    	[ [ -0.848, -0.556, -0.228, -0.304, 0.976, 1.64, -1.616 ], [ 0.424, 0.936, 0.648, -0.988, -1.1, 0.496, -0.596 ], [ 1.288, -1.456, -0.04, -0.02, 1.812, -0.396, -0.104 ], [ 0.048, 0.956, 0.22, 0.444, -0.736, -0.12, 0.928 ], [ -0.028, -0.288, 0.98, 0.056, -1.2, 1.648, 1.64 ] ],
    	[ [ -0.872, -1.268, 1.888, 0.016, 1.2, 0.296, 0.136 ], [ 0.684, -1.66, -1.04, -1.724, 0.824, 1.32, -1.996 ], [ 1.616, -0.36, 0.204, 0.048, 0.604, 1.012, -0.908 ], [ -1.668, -1.708
```
...[skipping 10930 bytes](etc/24.txt)...
```
    519231669108194E-13, ... ], [ -6.303846333821639E-13, 1.000088900582341E-12, 2.2605251004392812E-12, 6.01130256683291E-12, 1.8496315590255108E-13, 2.3656632208712836E-12, -4.9609205632350495E-12, -1.1302625502196406E-12, ... ], [ 0.0, -6.303846333821639E-13, 1.000088900582341E-12, 2.2605251004392812E-12, -2.8704816301683422E-12, 0.0, 2.3656632208712836E-12, 1.2802647830767455E-11, ... ], [ 0.0, 0.0, 0.0, 0.0, 0.0, 1.000088900582341E-12, 2.2605251004392812E-12, 6.01130256683291E-12, ... ], [ 0.0, 0.0, 0.0, 0.0, 0.0, -6.303846333821639E-13, 1.000088900582341E-12, 2.2605251004392812E-12, ... ], ... ]
    Error Statistics: {meanExponent=-11.487209564079928, negative=2852, min=-2.4868995751603507E-14, max=-2.4868995751603507E-14, mean=-3.304675360520864E-14, count=39375.0, positive=3063, stdDev=2.8947876619105517E-12, zeros=33460}
    Finite-Difference Derivative Accuracy:
    absoluteTol: 1.0575e-12 +- 3.1413e-12 [0.0000e+00 - 3.4492e-11] (61250#)
    relativeTol: 9.4081e-12 +- 3.2684e-11 [2.4328e-15 - 1.4022e-09] (11830#)
    
```

Returns: 

```
    ToleranceStatistics{absoluteTol=1.0575e-12 +- 3.1413e-12 [0.0000e+00 - 3.4492e-11] (61250#), relativeTol=9.4081e-12 +- 3.2684e-11 [2.4328e-15 - 1.4022e-09] (11830#)}
```



### Performance
Code from [StandardLayerTests.java:120](../../../../../../../../src/main/java/com/simiacryptus/mindseye/test/StandardLayerTests.java#L120) executed in 0.02 seconds: 
```java
    getPerformanceTester().test(layer, permPrototype);
```
Logging: 
```
    Evaluation performance: 0.000841s +- 0.000263s [0.000586s - 0.001182s]
    Learning performance: 0.001004s +- 0.000153s [0.000906s - 0.001307s]
    
```

